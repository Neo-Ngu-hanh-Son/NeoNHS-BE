# Frontend Guide: CRUD for Workshop Tags & Event Tags

> **Generated from:** Backend codebase analysis of `NeoNHS-BE`  
> **Date:** 2026-02-23  
> **Audience:** Frontend Developers

---

## Table of Contents

1. [Overview](#overview)
2. [Data Model](#data-model)
3. [API Endpoints — Event Tags](#api-endpoints--event-tags)
4. [API Endpoints — Workshop Tags](#api-endpoints--workshop-tags)
5. [Shared Response Format](#shared-response-format)
6. [CRUD Flow Diagrams](#crud-flow-diagrams)
7. [Validation Rules](#validation-rules)
8. [Error Handling](#error-handling)
9. [UI Implementation Guidelines](#ui-implementation-guidelines)
10. [Key Differences: ETag vs WTag](#key-differences-etag-vs-wtag)

---

## Overview

The system has **two independent tag systems** that follow the same data shape but have different business rules and API contracts:

| Feature               | Event Tag (ETag)  | Workshop Tag (WTag) |
| --------------------- | ----------------- | ------------------- |
| Entity                | `ETag`            | `WTag`              |
| Table                 | `etags`           | `wtags`             |
| Admin Base URL        | `/api/admin/tags` | `/api/wtags`        |
| Public Base URL       | `/api/tags`       | `/api/wtags`        |
| Auth (Write)          | `ROLE_ADMIN`      | `ROLE_ADMIN`        |
| Auth (Read)           | Public            | Public              |
| Soft Delete           | ✅ Yes            | ❌ No (Hard delete) |
| Restore               | ✅ Yes            | ❌ No               |
| Name Uniqueness Check | ✅ Yes            | ❌ No               |

---

## Data Model

Both tags share the **same field structure**:

```ts
interface TagBase {
  id: string; // UUID (generated by backend)
  name: string; // Required, unique (ETag only)
  description?: string;
  tagColor?: string; // e.g., "#FF5733" or "red"
  iconUrl?: string; // URL to an icon image
}

// ETag response inherits TagBase (no extra fields exposed)
type TagResponse = TagBase;

// WTag response inherits TagBase (no extra fields exposed)
type WTagResponse = TagBase;
```

> **Note:** `createdAt`, `updatedAt`, `deletedAt`, `deletedBy` exist in the database but are **not returned** in the current response DTOs.

---

## API Endpoints — Event Tags (ETag)

### Authentication

| Operation                          | Required Role                  |
| ---------------------------------- | ------------------------------ |
| Read (list/detail)                 | Public (no auth)               |
| Create / Update / Delete / Restore | `ADMIN` — include Bearer token |

---

### 1. Get All Active Tags (Public — for dropdowns/filters)

```
GET /api/tags
```

- **Auth:** None
- **Returns:** Flat list of active (non-deleted) tags

**Response:**

```json
{
  "status": 200,
  "success": true,
  "message": "Tags retrieved successfully",
  "data": [
    {
      "id": "uuid",
      "name": "Health",
      "description": "Health-related events",
      "tagColor": "#4CAF50",
      "iconUrl": "https://example.com/icon.png"
    }
  ],
  "timestamp": "2026-02-23T10:00:00"
}
```

---

### 2. Get All Tags — Admin (Paginated, includes soft-deleted)

```
GET /api/admin/tags?page=0&size=10&sortBy=createdAt&sortDir=desc
```

- **Auth:** `ADMIN` Bearer token required
- **Query Params:**

| Param     | Type     | Default     | Description          |
| --------- | -------- | ----------- | -------------------- |
| `page`    | `int`    | `0`         | Page index (0-based) |
| `size`    | `int`    | `10`        | Items per page       |
| `sortBy`  | `string` | `createdAt` | Field to sort by     |
| `sortDir` | `string` | `desc`      | `asc` or `desc`      |

**Response:**

```json
{
  "status": 200,
  "success": true,
  "message": "Tags retrieved successfully",
  "data": {
    "content": [ { ...TagResponse } ],
    "pageable": { ... },
    "totalElements": 50,
    "totalPages": 5,
    "last": false,
    "first": true,
    "size": 10,
    "number": 0
  },
  "timestamp": "2026-02-23T10:00:00"
}
```

---

### 3. Get Tag by ID — Admin

```
GET /api/admin/tags/{id}
```

- **Auth:** `ADMIN`
- **Path param:** `id` — UUID of the tag

**Response:**

```json
{
  "status": 200,
  "success": true,
  "message": "Tag retrieved successfully",
  "data": {
    "id": "uuid",
    "name": "Health",
    "description": "...",
    "tagColor": "#4CAF50",
    "iconUrl": "..."
  }
}
```

---

### 4. Create Event Tag

```
POST /api/admin/tags
Content-Type: application/json
Authorization: Bearer <admin_token>
```

**Request Body:**

```json
{
  "name": "Health",
  "description": "Health-related events",
  "tagColor": "#4CAF50",
  "iconUrl": "https://example.com/icon.png"
}
```

**Success Response (201 Created):**

```json
{
  "status": 201,
  "success": true,
  "message": "Tag created successfully",
  "data": { ...TagResponse }
}
```

---

### 5. Update Event Tag

```
PUT /api/admin/tags/{id}
Content-Type: application/json
Authorization: Bearer <admin_token>
```

- **Supports partial update** — only send fields you want to change
- **Name conflict check:** If `name` is provided and it differs from the current name, the backend checks for duplicates

**Request Body (all optional for update):**

```json
{
  "name": "Updated Name",
  "description": "New description",
  "tagColor": "#FF5733",
  "iconUrl": "https://new-icon.com/icon.png"
}
```

**Success Response (200 OK):**

```json
{
  "status": 200,
  "success": true,
  "message": "Tag updated successfully",
  "data": { ...TagResponse }
}
```

---

### 6. Soft Delete Event Tag

```
DELETE /api/admin/tags/{id}
Authorization: Bearer <admin_token>
```

- Sets `deletedAt` and `deletedBy` on the record (record still exists in DB)
- Tag will **no longer appear** in the public `/api/tags` list

**Success Response (200 OK):**

```json
{
  "status": 200,
  "success": true,
  "message": "Tag deleted successfully",
  "data": null
}
```

---

### 7. Restore Event Tag

```
PATCH /api/admin/tags/{id}/restore
Authorization: Bearer <admin_token>
```

- Clears `deletedAt` and `deletedBy` — tag becomes active again

**Success Response (200 OK):**

```json
{
  "status": 200,
  "success": true,
  "message": "Tag restored successfully",
  "data": { ...TagResponse }
}
```

---

## API Endpoints — Workshop Tags (WTag)

### Authentication

| Operation                | Required Role                  |
| ------------------------ | ------------------------------ |
| Read (list/detail)       | **Public** (no auth needed)    |
| Create / Update / Delete | `ADMIN` — include Bearer token |

---

### 1. Get All Workshop Tags (Paginated)

```
GET /api/wtags?page=0&size=10&sortBy=createdAt&sortDir=desc
```

- **Auth:** None (Public)

**Query Params:** Same as ETag admin list above.

**Response:** Paginated `Page<WTagResponse>` — same structure as ETag paginated response.

---

### 2. Get All Workshop Tags (No Pagination — for dropdowns)

```
GET /api/wtags/all
```

- **Auth:** None (Public)
- **Returns:** Flat `List<WTagResponse>`

---

### 3. Get Workshop Tag by ID

```
GET /api/wtags/{id}
```

- **Auth:** None (Public)

---

### 4. Create Workshop Tag

```
POST /api/wtags
Content-Type: application/json
Authorization: Bearer <admin_token>
```

**Request Body:**

```json
{
  "name": "Cooking",
  "description": "Cooking workshops",
  "tagColor": "#FFA500",
  "iconUrl": "https://example.com/cooking-icon.png"
}
```

**Success Response (201 Created):**

```json
{
  "status": 201,
  "success": true,
  "message": "Workshop tag created successfully",
  "data": { ...WTagResponse }
}
```

---

### 5. Update Workshop Tag

```
PUT /api/wtags/{id}
Content-Type: application/json
Authorization: Bearer <admin_token>
```

- **Supports partial update** — same as ETag
- **No name uniqueness check** on the backend for WTag

**Request Body (all optional):**

```json
{
  "name": "Updated Workshop Tag",
  "description": "...",
  "tagColor": "#123456",
  "iconUrl": "..."
}
```

---

### 6. Delete Workshop Tag (Hard Delete)

```
DELETE /api/wtags/{id}
Authorization: Bearer <admin_token>
```

> ⚠️ **IMPORTANT:** This is a **hard delete** — the record is permanently removed from the database. There is **no restore**.

**Success Response (200 OK):**

```json
{
  "status": 200,
  "success": true,
  "message": "Workshop tag deleted successfully",
  "data": null
}
```

---

## Shared Response Format

All endpoints return the standard `ApiResponse<T>` wrapper:

```ts
interface ApiResponse<T> {
  status: number; // HTTP status code
  success: boolean; // true for success, false for errors
  message: string; // Human-readable message
  data: T | null; // Payload (null on delete or error)
  timestamp: string; // ISO 8601 datetime from server
}
```

---

## CRUD Flow Diagrams

### Event Tag (ETag) Full Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                       EVENT TAG LIFECYCLE                        │
└─────────────────────────────────────────────────────────────────┘

   [Admin]                    [Backend]
      │                           │
      │  POST /api/admin/tags     │
      │  { name*, description,    │
      │    tagColor, iconUrl }     │  1. Validate @NotBlank(name)
      │──────────────────────────>│  2. Check existsByName → 400 if exists
      │                           │  3. Save to DB
      │  201 Created + TagResp    │
      │<──────────────────────────│
      │                           │
      │  PUT /api/admin/tags/{id} │
      │  { name?, desc?, ... }    │  1. Find by ID → 404 if not found
      │──────────────────────────>│  2. If name changed, check duplicate → 400
      │                           │  3. Partial update (null fields kept)
      │  200 OK + TagResp         │
      │<──────────────────────────│
      │                           │
      │  DELETE /api/admin/       │  1. Find by ID → 404 if not found
      │  tags/{id}                │  2. Check if already deleted → 400
      │──────────────────────────>│  3. Set deletedAt + deletedBy (SOFT)
      │  200 OK                   │
      │<──────────────────────────│
      │                           │
      │  PATCH /api/admin/        │  1. Find by ID → 404 if not found
      │  tags/{id}/restore        │  2. Check if NOT deleted → 400
      │──────────────────────────>│  3. Clear deletedAt + deletedBy
      │  200 OK + TagResp         │
      │<──────────────────────────│

[Public User]
      │  GET /api/tags            │  Returns only tags where deletedAt IS NULL
      │──────────────────────────>│
      │  200 OK + List<TagResp>   │
      │<──────────────────────────│
```

### Workshop Tag (WTag) Full Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                     WORKSHOP TAG LIFECYCLE                       │
└─────────────────────────────────────────────────────────────────┘

   [Admin]                    [Backend]
      │                           │
      │  POST /api/wtags          │
      │  { name*, description,    │  1. Validate @NotBlank(name)
      │    tagColor, iconUrl }     │  2. NO duplicate check
      │──────────────────────────>│  3. Save to DB
      │  201 Created + WTagResp   │
      │<──────────────────────────│
      │                           │
      │  PUT /api/wtags/{id}      │  1. Find by ID → 404 if not found
      │  { name?, desc?, ... }    │  2. NO duplicate check on name
      │──────────────────────────>│  3. Partial update
      │  200 OK + WTagResp        │
      │<──────────────────────────│
      │                           │
      │  DELETE /api/wtags/{id}   │  1. Find by ID → 404 if not found
      │──────────────────────────>│  2. HARD DELETE (permanent)
      │  200 OK                   │
      │<──────────────────────────│

[Public User]
      │  GET /api/wtags           │  Returns ALL tags (paginated)
      │──────────────────────────>│  (no soft-delete filter)
      │  GET /api/wtags/all       │  Returns ALL tags (no pagination)
      │──────────────────────────>│
```

---

## Validation Rules

### Frontend Validation (match backend constraints)

#### Event Tag (`ETag`) — Create

| Field         | Rule                              | Error Message                                        |
| ------------- | --------------------------------- | ---------------------------------------------------- |
| `name`        | **Required**, not blank           | `"Tag name is required"`                             |
| `name`        | Should be unique (backend checks) | `"Tag with name '...' already exists"` (from server) |
| `description` | Optional                          | —                                                    |
| `tagColor`    | Optional                          | —                                                    |
| `iconUrl`     | Optional, valid URL recommended   | —                                                    |

#### Event Tag (`ETag`) — Update

| Field      | Rule                                     | Error Message                                     |
| ---------- | ---------------------------------------- | ------------------------------------------------- |
| `name`     | Optional; if provided, must not be blank | Client-side: `"Name cannot be empty if provided"` |
| All others | Optional                                 | —                                                 |

> Do **not** send `name: ""` in the update payload — only send the field if the user wants to change it.

---

#### Workshop Tag (`WTag`) — Create

| Field         | Rule                             | Error Message                                  |
| ------------- | -------------------------------- | ---------------------------------------------- |
| `name`        | **Required**, not blank          | `"Tag name is required"`                       |
| `name`        | Max **100** characters           | `"Tag name must not exceed 100 characters"`    |
| `description` | Optional, max **255** characters | `"Description must not exceed 255 characters"` |
| `tagColor`    | Optional, max **20** characters  | `"Tag color must not exceed 20 characters"`    |
| `iconUrl`     | Optional                         | —                                              |

#### Workshop Tag (`WTag`) — Update

| Field         | Rule                                    | Error Message                                  |
| ------------- | --------------------------------------- | ---------------------------------------------- |
| `name`        | Optional; max **100** chars if provided | `"Tag name must not exceed 100 characters"`    |
| `description` | Optional; max **255** chars             | `"Description must not exceed 255 characters"` |
| `tagColor`    | Optional; max **20** chars              | `"Tag color must not exceed 20 characters"`    |
| `iconUrl`     | Optional                                | —                                              |

---

### Color Field Guidance

The `tagColor` field is a plain string. Recommended format conventions:

- `"#RRGGBB"` — hex color code (max 7 chars, well within 20 limit)
- `"#RGB"` — short hex
- Use a **color picker component** in the UI; store the hex string value

---

## Error Handling

### Common Error Responses

All error responses follow the same `ApiResponse` format with `success: false`:

#### 400 Bad Request — Validation Error

Occurs when:

- `name` is blank on create
- A field exceeds its max length
- Attempting to delete an already-deleted ETag
- Attempting to restore an ETag that is not deleted
- Creating an ETag with a duplicate name

```json
{
  "status": 400,
  "success": false,
  "message": "Tag with name 'Health' already exists",
  "data": null,
  "timestamp": "..."
}
```

Or for `@Valid` field-level errors, the format may be a map of errors:

```json
{
  "status": 400,
  "success": false,
  "message": "Validation failed",
  "data": {
    "name": "Tag name is required"
  }
}
```

#### 401 Unauthorized

Occurs when calling admin-protected endpoints without a valid Bearer token.

```json
{
  "status": 401,
  "success": false,
  "message": "Unauthorized"
}
```

#### 403 Forbidden

Occurs when a non-ADMIN user calls an admin endpoint.

#### 404 Not Found

```json
{
  "status": 404,
  "success": false,
  "message": "Tag not found with id: <uuid>",
  "data": null
}
```

---

### Frontend Error Handling Strategy

```ts
async function apiCall<T>(fn: () => Promise<ApiResponse<T>>): Promise<T> {
  try {
    const response = await fn();
    if (!response.success) {
      // Show error toast with response.message
      throw new Error(response.message);
    }
    return response.data;
  } catch (err) {
    if (err.status === 401) // redirect to login
    if (err.status === 403) // show "no permission" message
    if (err.status === 404) // show "not found"
    if (err.status === 400) // show validation errors inline
    // Default: show generic error toast
  }
}
```

---

## UI Implementation Guidelines

### Admin Tag Management Page (applies to both ETag and WTag)

#### 1. Tag List Table

| Column      | Source        | Notes                                              |
| ----------- | ------------- | -------------------------------------------------- |
| Name        | `name`        | Clickable to open detail/edit                      |
| Description | `description` | Truncate if too long                               |
| Color       | `tagColor`    | Show as a colored dot/badge                        |
| Icon        | `iconUrl`     | Show thumbnail if available                        |
| Status      | `deletedAt`   | **ETag only:** "Active" / "Deleted" badge          |
| Actions     | —             | Edit, Delete, Restore (ETag) / Edit, Delete (WTag) |

> **Pagination:** Use `page`, `size`, `sortBy`, `sortDir` query params. Show page selector and page size dropdown.

---

#### 2. Create Tag Form

```
┌──────────────────────────────────────────┐
│           Create New [Event/Workshop] Tag  │
├──────────────────────────────────────────┤
│ Name *           [__________________]    │
│                  Max: 100 chars (WTag)    │
│                                          │
│ Description      [__________________]    │
│                  [__________________]    │
│                  Max: 255 chars (WTag)   │
│                                          │
│ Tag Color        [Color Picker] #_______ │
│                  Max: 20 chars           │
│                                          │
│ Icon URL         [__________________]    │
│                  [Preview if valid URL]  │
│                                          │
│           [Cancel]    [Create Tag]       │
└──────────────────────────────────────────┘
```

**Behavior:**

- Show red border + error message below field when validation fails
- `name` field: show error immediately on blur if empty
- `tagColor`: show color preview swatch next to input
- `iconUrl`: show image preview on valid URL input
- Disable submit button while request is in progress (show spinner)
- On success: close modal/form, refresh list, show success toast

---

#### 3. Edit Tag Form

Same as Create form, but:

- Pre-populate all fields with current values
- Send only changed fields to the `PUT` endpoint
- Do **not** send a field at all if the user hasn't touched it (or send `null` explicitly to clear — be careful: backend ignores `null` values, so clearing a field is not currently supported via the partial update)

> **Important:** If a field is `null` in the request, the backend **will not update** that field. To effectively clear optional fields (description, tagColor, iconUrl), you may need to handle this case specially or send `""` if the backend supports it.

---

#### 4. Delete Action

**For ETag (Soft Delete):**

- Show a confirmation dialog:
  ```
  Are you sure you want to delete the tag "Health"?
  This tag will be deactivated but can be restored later.
  ```
- Call `DELETE /api/admin/tags/{id}`
- On success: update tag status badge to "Deleted" in the list (or remove from list if showing active only)

**For WTag (Hard Delete):**

- Show a stronger confirmation dialog:
  ```
  ⚠️ Are you sure you want to permanently delete the tag "Cooking"?
  This action CANNOT be undone.
  ```
- Call `DELETE /api/wtags/{id}`
- On success: remove from list entirely

---

#### 5. Restore Action (ETag only)

- Only show "Restore" button for tags with `deletedAt !== null`
- Confirmation dialog not required (low-risk action)
- Call `PATCH /api/admin/tags/{id}/restore`
- On success: update tag status badge to "Active"

---

#### 6. Color Tag Display

Render the `tagColor` field as a visual badge:

```tsx
// Example React component
<span
  style={{
    backgroundColor: tag.tagColor || "#ccc",
    borderRadius: "12px",
    padding: "2px 8px",
    color: getContrastColor(tag.tagColor),
    fontSize: "12px",
  }}
>
  {tag.name}
</span>
```

---

#### 7. Dropdown/Filter Integration (for assigning tags to Events/Workshops)

When building an Event creation form or Workshop creation form, use:

```
GET /api/tags        → for Event tag multi-select dropdown
GET /api/wtags/all   → for Workshop tag multi-select dropdown
```

Both return a flat list without pagination — ideal for dropdowns.

---

## Key Differences: ETag vs WTag

| Behavior                 | ETag (Event Tag)                        | WTag (Workshop Tag)                                                  |
| ------------------------ | --------------------------------------- | -------------------------------------------------------------------- |
| **Public Read**          | `GET /api/tags` (no pagination)         | `GET /api/wtags/all` (no pagination) OR `GET /api/wtags` (paginated) |
| **Admin Read**           | `GET /api/admin/tags` (paginated)       | Same as public URL `/api/wtags` (paginated)                          |
| **Name uniqueness**      | ✅ Enforced by backend                  | ❌ Not enforced                                                      |
| **Delete type**          | Soft delete (reversible)                | Hard delete (permanent)                                              |
| **Restore**              | ✅ `PATCH /api/admin/tags/{id}/restore` | ❌ Not available                                                     |
| **Visible when deleted** | Only in Admin list (`/api/admin/tags`)  | Never (permanently removed)                                          |
| **Show status badge**    | Yes ("Active" / "Deleted")              | No status badge needed                                               |
| **WTag field limits**    | No explicit size limits                 | name ≤ 100, desc ≤ 255, tagColor ≤ 20                                |

---

## Quick Reference: API Summary Table

### Event Tag

| Action                     | Method   | URL                            | Auth   |
| -------------------------- | -------- | ------------------------------ | ------ |
| Get all active (dropdown)  | `GET`    | `/api/tags`                    | Public |
| Get all (admin, paginated) | `GET`    | `/api/admin/tags`              | ADMIN  |
| Get by ID                  | `GET`    | `/api/admin/tags/{id}`         | ADMIN  |
| Create                     | `POST`   | `/api/admin/tags`              | ADMIN  |
| Update (partial)           | `PUT`    | `/api/admin/tags/{id}`         | ADMIN  |
| Soft Delete                | `DELETE` | `/api/admin/tags/{id}`         | ADMIN  |
| Restore                    | `PATCH`  | `/api/admin/tags/{id}/restore` | ADMIN  |

### Workshop Tag

| Action                  | Method   | URL               | Auth   |
| ----------------------- | -------- | ----------------- | ------ |
| Get all (no pagination) | `GET`    | `/api/wtags/all`  | Public |
| Get all (paginated)     | `GET`    | `/api/wtags`      | Public |
| Get by ID               | `GET`    | `/api/wtags/{id}` | Public |
| Create                  | `POST`   | `/api/wtags`      | ADMIN  |
| Update (partial)        | `PUT`    | `/api/wtags/{id}` | ADMIN  |
| Hard Delete             | `DELETE` | `/api/wtags/{id}` | ADMIN  |

---

_End of Guide_
